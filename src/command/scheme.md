# Схема описания

Для СО используется формат JSON.
Этот формат позволяет представить СО в виде иерархии ключей-значений.
Специальные ключи начинаются с `@` (аннотация), и используются для служебной информации.

Рассмотрим фрагмент типовой СО на примере.

```json
{
    "@protocol_version": "1.0",

    "ctrl": {
        "@access": "RW",
        "record": "bool",
        "vis": "bool",
        "event": { 
            "@type": "[u8]",
            "@access": "WO"
        },
        "erase": "()",
        "goto_loader": "()"
    }
}
```

Ключ `@protocol_version` декларирует версию СО, в данном случае 1.0.
Ключ `@protocol_version` является обязательным и должен всегда находится на первом уровне вложенности.

Описание секции `ctrl` декларирует наличие в ней следующих регистров:

- `record`
- `vis`
- `event`
- `erase`
- `goto_loader`

Например, путь до регистра event будет выглядеть так:

`/ctrl/event`

Регистры описываются `ключем: значением` или `ключем:{@аннтотация1, @аннтотация2}`.
Регистр не может иметь в себе вложенных секций и всегда является самым глубоким элементом вложенности.

Тип данных регистра может быть описан в виде значения ключа регистра, или в случае вложенного описания регистра
с помощью аннотации `@type`.

Например:

`record: bool`

или тоже самое, но с использованием вложенного описания:

```none
record: {
    @type: bool
}
```

В случае вложенного описания регистра, нужно обязательно указывать его тип данных с помощью аннотации `@type`,
обратное является ошибкой.
Об используемых типах данных регистров подробнее см. в разделе Протокол.

Ключ `@access` находящийся внутри секции `ctrl` определяет флаги чтения и записи для всего содержимого этой секции.
Подсекции и регистры вложенные в родительскую секцию наследуют ее `@access` флаги.
Для секций первого уровня по-умолчанию определен `@access: RO`, т.е. установлен режим только чтение.

Возможные значения `@access`:

- `RW` -- чтение/запись
- `RO`-- только чтение
- `WO`-- только запись

Флаги `@access` могут быть переопределены у более вложенных элементов, это демонстрируется на примере регистра `event`:

```json
{
    // По-умолчанию "@access": "RO" для корневой секции
    "ctrl": {
        // Секция ctrl переопределяет RO -> RW
        "@access": "RW",
        "event": {
            "@type": "[u8]",
            // Регистр event переопределяет RW -> WO
            "@access": "WO"
        },
    }
}
```

